import{_ as i,o as a,c as n,a2 as l}from"./chunks/framework.BGfUC0LL.js";const o=JSON.parse('{"title":"使用https访问内网服务","description":"","frontmatter":{},"headers":[],"relativePath":"tinker/network/使用https访问内网服务.md","filePath":"tinker/network/使用https访问内网服务.md","lastUpdated":1770864474000}'),h={name:"tinker/network/使用https访问内网服务.md"};function t(p,s,k,e,r,d){return a(),n("div",null,[...s[0]||(s[0]=[l(`<h1 id="使用https访问内网服务" tabindex="-1">使用https访问内网服务 <a class="header-anchor" href="#使用https访问内网服务" aria-label="Permalink to &quot;使用https访问内网服务&quot;">​</a></h1><blockquote><p><a href="https://github.com/linuxserver/docker-swag" target="_blank" rel="noreferrer">https://github.com/linuxserver/docker-swag</a></p></blockquote><h3 id="配置dns解析" tabindex="-1">配置dns解析 <a class="header-anchor" href="#配置dns解析" aria-label="Permalink to &quot;配置dns解析&quot;">​</a></h3><p>将需要的子域名使用ddns解析到wan口ip</p><h3 id="openwrt启动docker-swag容器" tabindex="-1">openwrt启动docker-swag容器 <a class="header-anchor" href="#openwrt启动docker-swag容器" aria-label="Permalink to &quot;openwrt启动docker-swag容器&quot;">​</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># docker-compose.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;3&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  swag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">linuxserver/swag:latest</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    container_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">swag</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    cap_add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">NET_ADMIN</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">PUID=1000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">PGID=1000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TZ=Asia/Shanghai</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 时区</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">URL=yourdomain.com</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 主域名</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">VALIDATION=dns</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # certbot验证的方法，一般选dns</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SUBDOMAINS=yoursubdoamin.yourdomain.com</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">CERTPROVIDER=</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 可以填zerossl，默认使用let&#39;s encrypt签发证书</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DNSPLUGIN=dnspod</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 支持aliyun、dnspod、cloudflare等等，详情见官方文档</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">PROPAGATION=</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 选择覆盖dns插件的默认传播时间（以秒为单位）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EMAIL=user@email.com</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 邮箱</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ONLY_SUBDOMAINS=true</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 是否只获取子域名的证书</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EXTRA_DOMAINS=</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 其他完全限定域名（逗号分隔，无空格）例如 extradomain.com,subdomain.anotherdomain.org</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">STAGING=false</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 设置为 true 以在暂存模式下检索证书。但生成的证书将无法通过浏览器的安全测试。仅用于测试。</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/docker/swag/config:/config</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">65111:443</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 映射端口，家宽可以选择高位端口</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#      - 80:80 #optional</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    restart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">unless-stopped</span></span></code></pre></div><h3 id="启动容器后操作" tabindex="-1">启动容器后操作 <a class="header-anchor" href="#启动容器后操作" aria-label="Permalink to &quot;启动容器后操作&quot;">​</a></h3><ol><li><p>在<code>config/dns-conf</code>目录中找到自己选择的dns插件的配置文件，按要求填写验证信息</p></li><li><p>在<code>config/nginx/proxy-confs</code>基于给出的模板配置文件修改出自己的虚拟主机配置，将请求反向代理到内网的指定服务</p></li><li><p>防火墙中配置端口转发规则：将要从外网访问的高位端口（例如65222）转发到上面映射的端口65111</p></li></ol><h3 id="重启容器" tabindex="-1">重启容器 <a class="header-anchor" href="#重启容器" aria-label="Permalink to &quot;重启容器&quot;">​</a></h3><p>此时即可通过<code>https://subdomain.domain.com:65222</code>来访问对应的内网服务</p>`,10)])])}const g=i(h,[["render",t]]);export{o as __pageData,g as default};
