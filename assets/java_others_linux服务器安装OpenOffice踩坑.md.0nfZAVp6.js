import{_ as o,c as t,o as a,a2 as i}from"./chunks/framework.CQECOx-R.js";const u=JSON.parse('{"title":"linux服务器安装OpenOffice踩坑","description":"","frontmatter":{},"headers":[],"relativePath":"java/others/linux服务器安装OpenOffice踩坑.md","filePath":"java/others/linux服务器安装OpenOffice踩坑.md","lastUpdated":1746516944000}'),n={name:"java/others/linux服务器安装OpenOffice踩坑.md"};function r(l,e,f,c,p,s){return a(),t("div",null,e[0]||(e[0]=[i('<h1 id="linux服务器安装openoffice踩坑" tabindex="-1">linux服务器安装OpenOffice踩坑 <a class="header-anchor" href="#linux服务器安装openoffice踩坑" aria-label="Permalink to &quot;linux服务器安装OpenOffice踩坑&quot;">​</a></h1><h2 id="背景" tabindex="-1">背景 <a class="header-anchor" href="#背景" aria-label="Permalink to &quot;背景&quot;">​</a></h2><p>最近公司项目需要做一个在线预览Office文件的功能,尝试了使用OpenOffice把Office文档转化成PDF格式和HTML格式的文件再由前端解析PDF或者直接通过iFrame访问HTML文件的方案,windows系统直接下载安装后cmd运行命令就可以启动openoffice的服务了.服务器就稍微麻烦一点,本文记录了我在自己的阿里云服务器上安装OpenOffice遇到的坑和解决的办法. 解压安装OpenOffice,这个网上搜一下有很多,不再详细记录.可以参考 <a href="https://www.cnblogs.com/Oliver-rebirth/p/Linux_openOffice.html" target="_blank" rel="noreferrer">linux环境下安装 openOffice 并启动服务</a></p><h2 id="遇到的问题" tabindex="-1">遇到的问题 <a class="header-anchor" href="#遇到的问题" aria-label="Permalink to &quot;遇到的问题&quot;">​</a></h2><ul><li>找不到Java运行环境 这个问题是因为我服务器上的JDK是解压版本的,虽然配置了JAVA_HOME这些但是openoffice识别不到,后来我就删了这个解压版的JDK,然后用yum命令安装了OpenJDK 1.8,命令:<code>yum install openjdk 1.8</code>重新配置了JAVA_HOME后解决了这个报错</li><li>找不到libXext.so.6 /opt/openoffice4/program/下缺少libXext.so.6文件 运行<code>yum install libXext.X86_64</code>. 这个是64位linux的版本,32位的系统需要改成对应的版本</li><li>no suitable windowing system found existing 运行<code>yum groupinstall &quot;X Window System&quot;</code>,我在运行这个命令的时候,又碰到了另一个报错:<strong>no packages in any requested group available to install or update</strong>, 这里命令后面要加上一些参数,执行<code>yum groupinstall &quot;X Window System&quot; --setoptgroup_package_type=mandatory.default.optional</code></li></ul><p>解决报错后,再重新执行启动服务的命令 <code>nohup ./soffice -headless -accept=&quot;socket,host=127.0.0.1,port=8100;urp;&quot; -nofirststartwizard &amp;</code></p><p>执行后可以使用netstat命令查看8100端口的占用情况<code>net stat -lnp|grep 8100</code> 可以看到soffice.bin就说明服务成功启动了</p><p>然后启动测试的demo后发现,office文件转换成PDF后中文出现乱码,这是因为服务器上没有中文字体,用ftp工具把windows的中文字体直接传到服务器上的/usr/share/fonts文件夹中,清除缓存后重新启动openoffice服务后就能正确显示中文了.</p>',8)]))}const O=o(n,[["render",r]]);export{u as __pageData,O as default};
